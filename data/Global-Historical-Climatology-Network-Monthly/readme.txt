0. 我做的修改

    选择qcf数据作为本次项目数据，并删除质量控制标志，只保留每月温度



1. 介绍

    1.1 概述

        GHCN-M第四版当前包含全球25000多个站点的月平均温度。在很大程度上，GHCN-M第四版使用与第三版相同的质量控制和偏差校正算法。与以前版本最大的区别是基于GHCN-Daily的大量数据和作为国际地表温度倡议数据库（ISTI; Rennie等，2014）的一部分收集的数据，从而大大扩展了站点集。

        当前有三个GHCN-M第四版版本：
        QCU：质量控制，未调整
        QCF：质量控制，调整，使用成对同质性算法（PHA，Menne和Williams，2009）。
        QFE：质量控制，调整，使用成对同质性算法估计。仅提供1961-2010年的数据。这是为了在计算正常值时最大程度地增加站点覆盖。有关更多信息，请参见Williams等人，2012年。

        注意：数据被放置在一个独立的目录中，该目录的命名方式如下：

        ghcnm.v4.x.y.YYYYMMDD 其中

        x = 随着主要数据添加而递增的整数
        y = 随着次要数据添加而递增的整数
        YYYY = 处理和生成特定数据集的年份
        MM = 处理和生成特定数据集的月份
        DD = 处理和生成特定数据集的日期

        在此阶段，不会对“x”和“y”进行递增。

2. 数据

    2.1 元数据

       元数据已从GHCN-Monthly v3传递。这包括基本的地理站点信息，如纬度、经度、海拔、站点名称等。然而，扩展的元数据信息，如周围的植被等，未传递，但在版本3中仍存在。

    2.1.1 元数据格式（.inv文件）

       变量          列           类型
       --------    -------     ----

       ID           1-11         整数
       LATITUDE     13-20        实数
       LONGITUDE    22-30        实数
       STNELEV      32-37        实数
       NAME         39-68        字符

       变量定义：

       ID：站点标识代码。前两个字符是FIPS国家代码

       LATITUDE：站点的纬度，以十进制度表示

       LONGITUDE：站点的经度，以十进制度表示

       STELEV：站点的海拔高度（以米为单位）。-999.0 = 缺失。

       NAME：站点名称

    2.2 数据（.dat文件）

         GHCNM v4目前的数据主要包括月平均温度。

    2.2.1 数据格式

          变量          列           类型
          --------    -------     ----

          ID           1-11         整数
          YEAR         12-15        整数
          ELEMENT      16-19        字符
          VALUE1       20-24        整数
          DMFLAG1      25-25        字符
          QCFLAG1      26-26        字符
          DSFLAG1      27-27        字符
            .            .           .
            .            .           .
            .            .           .
          VALUE12      108-112      整数
          DMFLAG12     113-113      字符
          QCFLAG12     114-114      字符
          DSFLAG12     115-115      字符

          变量定义：

          ID：站点标识代码。前两个字符是FIPS国家代码

          YEAR：站点记录的四位年份。

          ELEMENT：元素类型，月平均温度="TAVG"

          VALUE：月度值（MISSING=-9999）。温度值以摄氏度百分之一为单位，但表示为整数（例如，除以100.0即可获得整数摄氏度）。

          DMFLAG：数据测量标志，QCU/QCF有九个可能的值，QFE有一个值：

                  质量控制未调整/调整（QCU/QCF）标志：

                  空白 = 无相关的测量信息
                  a-i = 在计算月平均温度时缺失的天数（目前仅适用于1218个包含在GHCNM中的USHCN V2站点）

                  质量控制调整和估算（QFE）标志：
                  E = 数据已从PHA中的邻居估算出来

          QCFLAG：质量控制标志，在质量控制未调整（qcu）数据集中有十一个可能，在质量控制调整（qcf）数据集中有三个可能。

                  质量控制未调整（QCU）QC标志：
         
                  空白 = 未发生质量控制检查失败或无法评估。

                  注意：以下质量控制检查按执行顺序列出。当值被质量控制检查标记时，它不会在随后的检查中接受测试。

                  E = 标识具有给定年份的“相同”12个月值的不同站点（例如，当所有12个月都重复且至少有3个或更多非缺失数据月时，并且此外，当两个值之间的绝对差小于或等于0.015摄氏度时，这些值被认为是“相同”）

                  D = 月度值是站点记录中另一个日历年内完全相同（例如，复制）的年度值系列的一部分。

                  R = 标记大于或小于已知的世界TAVG极端值的值。

                  K = 识别和标记五个或更多连续月份中相同值（非缺失）的运行

                  W = 月度值是根据地区和空间标准从上个月复制的（注意：该测试仅适用于2000年至今的数据，并且一般仅适用于几乎实时生成的数据源）。

                  I = 在TMAX和TMIN之间检查内部一致性。当给定月份的TMIN > TMAX时，设置标志。

                  L = 月度值在站点记录中被孤立在时间上，并在以下情况下被标记：

                      1）一个非缺失值在时间上至少有18个缺失值之前和之后。或者

                      2）一个非缺失值属于“簇”的2个相邻（在时间上）非缺失值，而该簇的
                         值在簇之前和之后至少有18个缺失值。或者

                      3）一个非缺失值属于“簇”的3个相邻（在时间上）非缺失值，而该簇的
                         值在簇之前和之后至少有18个缺失值。

                  O = 月度值大于或等于5个双权标准偏差的值
                      从该特定月份的站点记录中的所有非缺失值中计算出双权统计。
 
                  S = 当站点z分数满足以下任一算法条件时，标志值。
                  
                      定义：

                      邻居 = 目标站点附近500公里内的任何站点。
                      z分数 = （双权标准偏差/双权平均值）
                      S(Z) = 站点的z分数
                      N(Z) = “5”个最近的非缺失邻居z分数的集合。
                             （注意：此集合可能包含少于5个邻居，
                             但必须至少有一个邻居z分数用于
                             算法执行）

                      算法：

                      S(Z) >= 4.0且< 5.0且“所有”N(Z) < 1.9
                      S(Z) >= 3.0且< 4.0且“所有”N(Z) < 1.8
                      S(Z) >= 2.75且< 3.0且“所有”N(Z) < 1.7
                      S(Z) >= 2.5且< 2.75且“所有”N(Z) < 1.6
                      S(Z) <= -4.0且> -5.0且“所有”N(Z) > -1.9
                      S(Z) <= -3.0且> -4.0且“所有”N(Z) > -1.8
                      S(Z) <= -2.75且> -3.0且“所有”N(Z) > -1.7
                      S(Z) <= -2.5且> -2.75且“所有”N(Z) > -1.6
                                   
                  T = 当温度z分数与500公里范围内所有邻居的反距离加权z分数比较时
                      大于或等于3.0时，标识并标记。
                 

                  M = 手动标记为错误。

                  质量控制调整（QCF）QC标志：

                  A = 使用备用调整方法。

                  M = 具有在“qcu”数据集中的非空白质量控制标志的值在调整数据集中被设置为缺失，并且具有“M”质量控制标志。

                  X = 因同质性太多而删除了值的成对算法。

          DSFLAG：月度值的数据源标志

                  有关数据源标志的更多信息，请参阅ghcnm-flags.txt